<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fixture-card {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold text-center">‚öΩ Football Fixtures Hub</h1>
            <p class="text-center text-blue-100 mt-2">Big Leagues & International Fixtures - Live Data</p>
        </div>
    </header>

    <!-- API Key Setup -->
    <div id="apiSetup" class="container mx-auto px-4 mt-6">
        <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 max-w-2xl mx-auto">
            <h2 class="text-xl font-bold mb-4">üîë API Setup Required</h2>
            <p class="text-gray-300 mb-4">To fetch live fixtures, you need an API key from API-Football (free tier available).</p>
            <div class="bg-gray-900 rounded p-4 mb-4">
                <p class="text-sm mb-2"><strong>Steps to get your API key:</strong></p>
                <ol class="text-sm text-gray-300 space-y-1 ml-4 list-decimal">
                    <li>Visit <a href="https://www.api-football.com/" target="_blank" class="text-blue-400 hover:underline">api-football.com</a></li>
                    <li>Sign up for a free account</li>
                    <li>Go to your dashboard and copy your API key</li>
                    <li>Paste it below (Free tier: 100 requests/day)</li>
                </ol>
            </div>
            <div class="flex gap-2">
                <input type="text" id="apiKeyInput" placeholder="Enter your API-Football key" class="flex-1 bg-gray-900 text-white px-4 py-2 rounded-lg border border-gray-700 focus:border-blue-500 focus:outline-none">
                <button onclick="saveApiKey()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-semibold transition">
                    Save & Load Data
                </button>
            </div>
            <p class="text-xs text-gray-400 mt-2">Note: Your API key is stored locally in your browser only.</p>
            
            <div class="mt-4 p-4 bg-yellow-900 border border-yellow-700 rounded">
                <p class="text-sm"><strong>Alternative:</strong> Use demo mode with sample data</p>
                <button onclick="useDemoMode()" class="mt-2 bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg font-semibold transition text-sm">
                    Use Demo Mode
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content (hidden until API key is set) -->
    <div id="mainContent" class="hidden">
        <!-- League Tabs -->
        <div class="container mx-auto px-4 mt-6">
            <div class="flex flex-wrap gap-2 justify-center mb-6">
                <button onclick="filterLeague(39, 'Premier League')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    Premier League
                </button>
                <button onclick="filterLeague(140, 'La Liga')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    La Liga
                </button>
                <button onclick="filterLeague(135, 'Serie A')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    Serie A
                </button>
                <button onclick="filterLeague(78, 'Bundesliga')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    Bundesliga
                </button>
                <button onclick="filterLeague(61, 'Ligue 1')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    Ligue 1
                </button>
                <button onclick="filterLeague(2, 'Champions League')" class="league-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition">
                    Champions League
                </button>
            </div>

            <!-- Date Range -->
            <div class="flex justify-center mb-6 gap-2">
                <input type="date" id="fromDate" class="bg-gray-800 text-white px-4 py-2 rounded-lg border border-gray-700 focus:border-blue-500 focus:outline-none">
                <span class="flex items-center text-gray-400">to</span>
                <input type="date" id="toDate" class="bg-gray-800 text-white px-4 py-2 rounded-lg border border-gray-700 focus:border-blue-500 focus:outline-none">
                <button onclick="loadFixtures()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-semibold transition">
                    Load Fixtures
                </button>
            </div>

            <!-- API Info -->
            <div class="text-center mb-4">
                <p class="text-sm text-gray-400">
                    <span id="requestCount">-</span> API requests used today
                    <button onclick="clearApiKey()" class="ml-4 text-red-400 hover:underline text-xs">
                        Clear API Key
                    </button>
                </p>
            </div>

            <!-- Loading Spinner -->
            <div id="loading" class="hidden flex justify-center items-center py-12">
                <div class="spinner"></div>
                <span class="ml-4 text-gray-400">Loading fixtures...</span>
            </div>

            <!-- Fixtures Grid -->
            <div id="fixturesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="col-span-full text-center py-12">
                    <p class="text-gray-400 text-lg">Select a league and date range to view fixtures</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let apiKey = localStorage.getItem('footballApiKey');
        let currentLeagueId = null;
        let currentLeagueName = '';
        let isDemoMode = false;

        // Demo data
        const demoFixtures = [
            {
                league: { id: 39, name: 'Premier League', logo: '' },
                teams: { home: { name: 'Manchester City', logo: '' }, away: { name: 'Arsenal', logo: '' } },
                fixture: { date: '2025-11-08T16:30:00+00:00', venue: { name: 'Etihad Stadium', city: 'Manchester' }, status: { short: 'NS' } }
            },
            {
                league: { id: 39, name: 'Premier League', logo: '' },
                teams: { home: { name: 'Liverpool', logo: '' }, away: { name: 'Chelsea', logo: '' } },
                fixture: { date: '2025-11-09T14:00:00+00:00', venue: { name: 'Anfield', city: 'Liverpool' }, status: { short: 'NS' } }
            },
            {
                league: { id: 140, name: 'La Liga', logo: '' },
                teams: { home: { name: 'Real Madrid', logo: '' }, away: { name: 'Barcelona', logo: '' } },
                fixture: { date: '2025-11-10T20:00:00+00:00', venue: { name: 'Santiago Bernab√©u', city: 'Madrid' }, status: { short: 'NS' } }
            },
            {
                league: { id: 135, name: 'Serie A', logo: '' },
                teams: { home: { name: 'Inter', logo: '' }, away: { name: 'AC Milan', logo: '' } },
                fixture: { date: '2025-11-08T19:45:00+00:00', venue: { name: 'San Siro', city: 'Milano' }, status: { short: 'NS' } }
            },
            {
                league: { id: 78, name: 'Bundesliga', logo: '' },
                teams: { home: { name: 'Bayern Munich', logo: '' }, away: { name: 'Borussia Dortmund', logo: '' } },
                fixture: { date: '2025-11-09T17:30:00+00:00', venue: { name: 'Allianz Arena', city: 'M√ºnchen' }, status: { short: 'NS' } }
            },
            {
                league: { id: 61, name: 'Ligue 1', logo: '' },
                teams: { home: { name: 'Paris Saint Germain', logo: '' }, away: { name: 'Marseille', logo: '' } },
                fixture: { date: '2025-11-11T20:45:00+00:00', venue: { name: 'Parc des Princes', city: 'Paris' }, status: { short: 'NS' } }
            },
            {
                league: { id: 2, name: 'Champions League', logo: '' },
                teams: { home: { name: 'Real Madrid', logo: '' }, away: { name: 'Manchester City', logo: '' } },
                fixture: { date: '2025-11-12T21:00:00+00:00', venue: { name: 'Santiago Bernab√©u', city: 'Madrid' }, status: { short: 'NS' } }
            }
        ];

        function init() {
            if (apiKey || isDemoMode) {
                document.getElementById('apiSetup').classList.add('hidden');
                document.getElementById('mainContent').classList.remove('hidden');
                setDefaultDates();
            }
        }

        function setDefaultDates() {
            const today = new Date();
            const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
            document.getElementById('fromDate').value = today.toISOString().split('T')[0];
            document.getElementById('toDate').value = nextWeek.toISOString().split('T')[0];
        }

        function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (!key) {
                alert('Please enter an API key');
                return;
            }
            localStorage.setItem('footballApiKey', key);
            apiKey = key;
            isDemoMode = false;
            init();
        }

        function useDemoMode() {
            isDemoMode = true;
            init();
            alert('Demo mode activated! Using sample fixture data.');
        }

        function clearApiKey() {
            if (confirm('Clear API key and return to setup?')) {
                localStorage.removeItem('footballApiKey');
                apiKey = null;
                isDemoMode = false;
                location.reload();
            }
        }

        async function filterLeague(leagueId, leagueName) {
            currentLeagueId = leagueId;
            currentLeagueName = leagueName;
            
            document.querySelectorAll('.league-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-gray-700');
                btn.classList.add('bg-gray-700');
            });
            event.target.classList.remove('bg-gray-700');
            event.target.classList.add('bg-blue-600');
            
            await loadFixtures();
        }

        async function loadFixtures() {
            if (!currentLeagueId) {
                alert('Please select a league first');
                return;
            }

            const fromDate = document.getElementById('fromDate').value;
            const toDate = document.getElementById('toDate').value;

            if (!fromDate || !toDate) {
                alert('Please select date range');
                return;
            }

            if (isDemoMode) {
                const filtered = demoFixtures.filter(f => f.league.id === currentLeagueId);
                renderFixtures(filtered);
                return;
            }

            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('fixturesContainer').innerHTML = '';

            try {
                const response = await fetch(
                    `https://v3.football.api-sports.io/fixtures?league=${currentLeagueId}&season=2025&from=${fromDate}&to=${toDate}`,
                    {
                        method: 'GET',
                        headers: {
                            'x-rapidapi-host': 'v3.football.api-sports.io',
                            'x-rapidapi-key': apiKey
                        }
                    }
                );

                const data = await response.json();
                
                if (data.errors && Object.keys(data.errors).length > 0) {
                    throw new Error('API Error: ' + JSON.stringify(data.errors));
                }

                document.getElementById('requestCount').textContent = 
                    data.requests?.current || '-';

                renderFixtures(data.response || []);
            } catch (error) {
                console.error('Error fetching fixtures:', error);
                document.getElementById('fixturesContainer').innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-red-400 text-lg mb-2">Error loading fixtures</p>
                        <p class="text-gray-400 text-sm">${error.message}</p>
                        <p class="text-gray-500 text-xs mt-4">Check your API key and make sure you haven't exceeded the daily limit</p>
                    </div>
                `;
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function renderFixtures(fixtures) {
            const container = document.getElementById('fixturesContainer');
            
            if (!fixtures || fixtures.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-400 text-xl">No fixtures found for the selected dates</p>
                        <p class="text-gray-500 text-sm mt-2">Try a different date range</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = fixtures.map(fixture => {
                const date = new Date(fixture.fixture.date);
                const status = getStatusBadge(fixture.fixture.status.short);
                
                return `
                    <div class="fixture-card bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition border border-gray-700 hover:border-blue-500">
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 flex justify-between items-center">
                            <p class="text-sm font-semibold">${fixture.league.name}</p>
                            ${status}
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-4">
                                <div class="text-center flex-1">
                                    ${fixture.teams.home.logo ? `<img src="${fixture.teams.home.logo}" alt="${fixture.teams.home.name}" class="w-12 h-12 mx-auto mb-2">` : ''}
                                    <p class="font-bold text-base">${fixture.teams.home.name}</p>
                                </div>
                                <div class="mx-4">
                                    <div class="text-gray-400 font-bold text-xl">VS</div>
                                </div>
                                <div class="text-center flex-1">
                                    ${fixture.teams.away.logo ? `<img src="${fixture.teams.away.logo}" alt="${fixture.teams.away.name}" class="w-12 h-12 mx-auto mb-2">` : ''}
                                    <p class="font-bold text-base">${fixture.teams.away.name}</p>
                                </div>
                            </div>
                            <div class="border-t border-gray-700 pt-4 space-y-2">
                                <div class="flex items-center text-sm text-gray-300">
                                    <span class="mr-2">üìÖ</span>
                                    <span>${date.toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' })}</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-300">
                                    <span class="mr-2">‚è∞</span>
                                    <span>${date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}</span>
                                </div>
                                ${fixture.fixture.venue.name ? `
                                <div class="flex items-center text-sm text-gray-300">
                                    <span class="mr-2">üèüÔ∏è</span>
                                    <span>${fixture.fixture.venue.name}, ${fixture.fixture.venue.city || ''}</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getStatusBadge(status) {
            const badges = {
                'NS': '<span class="bg-gray-700 text-xs px-2 py-1 rounded">Not Started</span>',
                '1H': '<span class="bg-green-600 text-xs px-2 py-1 rounded">1st Half</span>',
                'HT': '<span class="bg-yellow-600 text-xs px-2 py-1 rounded">Half Time</span>',
                '2H': '<span class="bg-green-600 text-xs px-2 py-1 rounded">2nd Half</span>',
                'FT': '<span class="bg-blue-600 text-xs px-2 py-1 rounded">Finished</span>',
                'PST': '<span class="bg-red-600 text-xs px-2 py-1 rounded">Postponed</span>',
            };
            return badges[status] || `<span class="bg-gray-600 text-xs px-2 py-1 rounded">${status}</span>`;
        }

        init();
    </script>
</body>
</html>